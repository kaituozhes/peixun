<extend name="public/base" />
<block name="main">
<script src="__PUBLIC__/web/laydate/laydate.js"></script>
<style>
#studio span{cursor:pointer;}
.laydate_box, .laydate_box * {
    box-sizing:content-box;
}

</style>
<div class="tpl-content-wrapper">
    <div class="tpl-content-page-title">
        学员信息添加
    </div>
    <ol class="am-breadcrumb">
        <li><a href="{:U('index/index')}" class="am-icon-home">首页</a></li>
        <li><a href="{:U('member/student')}">学员信息管理</a></li>
        <li class="am-active">学员信息添加</li>
    </ol>
    <div class="tpl-portlet-components">
        <div class="portlet-title">
            <div class="caption font-green bold">
                <span class="am-icon-code"></span> 添加
            </div>
            <div class="tpl-portlet-input tpl-fz-ml">
              <!--   <div class="portlet-input input-small input-inline">
                  <div class="input-icon right">
                      <i class="am-icon-search"></i>
                      <input type="text" class="form-control form-control-solid" placeholder="搜索..."> </div>
              </div> -->
            </div>
        </div>

        <div class="tpl-block">

            <div class="am-g">
                <div class="tpl-form-body tpl-form-line">
                    <form class="am-form tpl-form-line-form" enctype="multipart/form-data" method="post" action="{:U('member/student_adds')}">
                        <input type="hidden" id="student_id" name="student_id" value="">
                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">身份证 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="ids" class="tpl-form-input" id="ids" placeholder="身份证" value=""><p></p>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">姓名 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="realname" class="tpl-form-input" id="realname" placeholder="姓名" value=""><p></p>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">性别 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <select name="sex" id="selectID" class="tpl-form-input">
                                    <option value="0" style="display:none;">选择性别</option>
                                    <option value="1">男</option>
                                    <option value="2">女</option>
                                </select>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">手机号 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="tel" class="tpl-form-input" id="tel" placeholder="电话" value=""><p></p>
                            </div>
                        </div>
                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">邮箱 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="email" class="tpl-form-input" id="email" placeholder="XXXX@163.com" value=""><p></p>
                            </div>
                        </div>


                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">学号 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="numeric" class="tpl-form-input" id="numeric" placeholder="学号" value=""><p></p>
                            </div>
                        </div>




                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">出生日期 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" onclick="laydate()" name="birth" class="tpl-form-input" id="birth" placeholder="出生年月" value="">
                            </div>
                        </div>
                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">学历信息 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="education" class="tpl-form-input" id="education" placeholder="学历信息" value="">
                            </div>
                        </div>
                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">联系地址<span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" name="region" class="tpl-form-input" id="region" placeholder="联系地址" value="">
                            </div>
                        </div>
                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">注册时间 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9">
                                <input type="text" onclick="laydate()" name="zidingtime" class="tpl-form-input" id="birth" placeholder="" value="">
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label">科目选择 <span class="tpl-form-line-small-title"></span></label>
                            <div class="am-u-sm-9" id="checkbox-box">
                                <volist name="ass" id="vo">
                                <br>
                                <input type="checkbox" name="subject_id[]" value="{$vo['subject_id']}"/>{$vo['agencyrealname']}--{$vo['subject_name']}
                                </volist>

                                <volist name="abb" id="vo">
                                <br>
                                <input type="checkbox" name="subject_id[]" onclick="return false;" value="{$vo['subject_id']}"/><span style="color:#CCCCCC;">{$vo['agencyrealname']}--{$vo['subject_name']}</span>
                                </volist>

                            </div>
                        </div>



                        <div class="am-form-group">
                            <div class="am-u-sm-9 am-u-sm-push-3">
                                <button type="submit" class="am-btn am-btn-primary tpl-btn-bg-color-success">提交</button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </div>


    </div>
</div>
<script type="text/javascript">
    $(function(){
        var realname = false;
        var tel = false;
        var email = false;
        var numeric = false;
        var ids = false;
        //验证姓名
        $('input[name=realname]').blur(function(){
            var na = $(this).val();
            if(na.length == 0){
                $(this).next().html('*姓名不能为空！');
                return realname = false;
            }else{

                $(this).next().html('');
                return realname = true;
            }
        })
        //验证电话
        $('input[name=tel]').blur(function(){
            var n = $(this).val();
            if(n.length != 11){

                $(this).next().html('*手机号格式不正确！');
                return tel = false;
            }else{

                $(this).next().html('');
                return tel = true;
            }
        })
        //验证学号
        $('input[name=numeric]').blur(function(){
            var nu = $(this).val();
            if(nu.length <= 9){

                $(this).next().html('*学号格式不正确！');
                return numeric = false;
            }else{

                $(this).next().html('');
                return numeric = true;
            }
        })
        //验证身份证
        $('input[name=ids]').blur(function(){
            var id = $(this).val();
            if(id.length != 18){

                $(this).next().html('*身份证格式不正确！');
                return ids = false;
            }else{

                $(this).next().html('');
                return ids = true;
            }
        })
        //验证邮箱
        $('input[name=email]').blur(function(){
            var na = $(this).val();
            var ret = /^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/;
            if(na.length == 0){
                $(this).next().html('*邮箱不能为空！');
                return email = false;
            }else if(!ret.test(na)){
               $(this).next().html('*邮箱格式不正确！');
                return email = false;
            }else{
                $(this).next().html('');
                return email = true;
            }
        })


        $('.am-btn').click(function(){
            $('input[name=realname]').blur();
            $('input[name=tel]').blur();
            $('input[name=email]').blur();
            $('input[name=numeric]').blur();
            $('input[name=ids]').blur();
            if(realname && tel && email && numeric && ids){

                return true;
            }else{
                return false;
            }
        })
    })
    /*ajax查询有无该学员*/
    $(function(){
      var ids;
      $('#ids').blur(function(){
        ids = $(this).val();
        $.get("{:U('member/ajax_get_student')}",{ids:ids},function(msg){
          if(msg){
            setvalue('student_id',msg['student_id']);
            setvalue('realname',msg['realname']);
            setvalue('region',msg['region']);
            setvalue('email',msg['email']);
            setvalue('sex',msg['sex']);
            setvalue('tel',msg['tel']);
            setvalue('numeric',msg['numeric']);
            setvalue('birth',msg['birth']);
            setvalue('education',msg['education']);
            var selectid = msg['sex'];
            $("#selectID").val(selectid);
            /*$("#selectID").attr("disabled", true);*/
            //选中
            var arr = msg['subject_id'].split(',');
            for (var i = 0; i <= arr.length - 1; i++) {
                //alert(arr[i]);
                $('#checkbox-box').find('input').each(function(){
                    var hs = $(this).val();
                    if(hs == arr[i]){
                        $(this).prop('checked',true);
                    }
                })

            };
            //选中
          }else{
            delvalue('student_id');
            delvalue('realname');
            delvalue('region');
            delvalue('numeric');
            delvalue('email');
            delvalue('sex');
            delvalue('tel');
            delvalue('birth');
            delvalue('education');
            $("#selectID").val(0);
            //删除选中
            var con = $("#checkbox-box input").length;
            for (var i = 0; i <= con - 1; i++) {
                $('#checkbox-box').find('input').each(function(){
                        $(this).removeAttr('checked',false);

                })

            };
            //删除选中
          }
        })
      })
      //赋值
      function setvalue(dom,value)
      {
         $('#'+dom).val(value);

      }
      //删除
      function delvalue(dom)
      {
            $('#'+dom).val('');
            $('#'+dom).removeAttr('disabled');
      }
  })

</script>








</block>
