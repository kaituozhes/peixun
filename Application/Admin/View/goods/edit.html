<extend name="public/base" />
<block name="main">
<style>
.laydate_box, .laydate_box * {
    box-sizing:content-box;
}
</style>
<link rel="stylesheet" href="__PUBLIC__/qingchunpao/home/css/uploadimg.css">
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor.all.min.js"> </script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/lang/zh-cn/zh-cn.js"></script>
<div class="tpl-content-wrapper">
<div class="tpl-content-page-title">
    活动管理
</div>
<ol class="am-breadcrumb">
    <li><a href="#" class="am-icon-home">首页</a></li>
    <li><a href="#">活动管理</a></li>
    <li class="am-active">活动修改</li>
</ol>
<div class="tpl-portlet-components">
    <div class="portlet-title">
        <div class="caption font-green bold">
            <span class="am-icon-code"></span> 修改
        </div>
        <div class="tpl-portlet-input tpl-fz-ml">
            <div class="portlet-input input-small input-inline">
                <div class="input-icon right">
                    <i class="am-icon-search"></i>
                    <input type="text" class="form-control form-control-solid" placeholder="搜索..."> </div>
            </div>
        </div>
    </div>
    <div class="tpl-block ">

        <div class="am-g tpl-amazeui-form">


            <div class="am-u-sm-12 am-u-md-9">
                <form class="am-form am-form-horizontal" method="post" action="" enctype="multipart/form-data">
                    <div class="am-form-group">
                        <label for="user-name" class="am-u-sm-3 am-form-label">选择城市 / city</label>
                        <div class="am-u-sm-9" id="box">
                                <select id="s_province" name="s_province" style="width:50%;float:left;">
                                    <option value="">请选择省</option>
                                </select>
                                <select id="s_city" name="s_city" style="width:50%;float:left;">
                                    <option value="">请选择市</option>
                                </select>
                        </div>
                        <input type="hidden" name="cityid" value="">
                    </div>

                    <div class="am-form-group">
                        <label for="user-email" class="am-u-sm-3 am-form-label">报名时间</label>
                        <div class="am-u-sm-9">
                            <input  onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})" type="text" placeholder="报名时间" name="applytime" value="">
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="user-email" class="am-u-sm-3 am-form-label">项目时间</label>
                        <div class="am-u-sm-9">
                            <input type="text" class="am-form-field tpl-form-no-bg" placeholder="项目时间" data-am-datepicker="" readonly="" value="" name="itemtime">
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="user-name" class="am-u-sm-3 am-form-label">详细地址</label>
                        <div class="am-u-sm-9">
                            <input type="text" name="gaddress" value="" placeholder="详细地址">
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="user-name" class="am-u-sm-3 am-form-label">顶部banner</label>
                        <div class="am-u-sm-9">
                            <div class="am-form-group am-form-file">
                              <button type="button" class="am-btn am-btn-danger am-btn-sm">
                                <i class="am-icon-cloud-upload"></i> 选择要上传的文件</button>
                                <input id="doc-form-file" name="topbanner" type="file" multiple>
                            </div>
                            <div id="file-list" style="float:left;"></div>
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="user-intro" class="am-u-sm-3 am-form-label">活动描述</label>
                        <div class="am-u-sm-9">
                            <textarea class="" rows="5" name="doinginfo" id="user-intro" placeholder="输入活动描述"></textarea>
                            <small>当活动推荐到首页时,该活动描述为必选项</small>
                        </div>
                    </div>
                    
                    <div class="am-form-group">
                        <label for="user-name" class="am-u-sm-3 am-form-label">视频链接</label>
                        <div class="am-u-sm-9">
                            <input type="text" id="user-name" name="videolink" placeholder="视频链接">
                            <small>当活动推荐到首页时,该活动描述为必选项</small>
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="user-intro" class="am-u-sm-3 am-form-label">推荐首页</label>
                        <div class="am-u-sm-9">
                            <div class="am-form-group">
                              <label class="am-radio-inline">
                                <input type="radio"  value="1" name="if_index">是
                              </label>
                              <label class="am-radio-inline">
                                <input type="radio" value="2" name="if_index">否
                              </label>
                            </div>
                        </div>
                    </div>

                    <div class="am-form-group">
                        <label for="user-name" class="am-u-sm-3 am-form-label">图片展示</label>
                        <div class="am-u-sm-9">
                            <div id="uploader" class="wu-example">
                                <div class="queueList">
                                    <div id="dndArea" class="placeholder">
                                        <div id="filePicker"></div>
                                        <p>或将照片拖到这里，单次最多可选300张</p>
                                    </div>
                                </div>
                                <div class="statusBar" style="display:none;">
                                    <div class="progress">
                                        <span class="text">0%</span>
                                        <span class="percentage"></span>
                                    </div><div class="info"></div>
                                    <div class="btns">
                                        <div id="filePicker2"></div><div class="uploadBtn">开始上传</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" name="imgpath" value="">
                    </div>
                    

                    

                    <div class="am-form-group">
                        <label for="user-intro" class="am-u-sm-3 am-form-label">活动信息 / Intro</label>
                        <div class="am-u-sm-9">
                            <script id="editor" type="text/plain" style="width:100%;height:450px;"></script>
                            <input type="hidden" name="doingmess" value="">
                        </div>
                    </div>


                        
                    <div class="am-form-group">
                        <div class="am-u-sm-9 am-u-sm-push-3">
                            <button type="submit" id="btn" class="am-btn am-btn-primary">保存修改</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</div>
<script src="__PUBLIC__/qingchunpao/home/js/uploadimg.js"></script>
<script src="__PUBLIC__/qingchunpao/home/js/changeeditor.js"></script>
<script>
$(function(){
    function getCity(obj,value)
    {
        $.get("{:U('Index/area')}",{'upid':value},function(msg){
            // 1.msg是对象，将对象遍历拼接成option格式的HTML标签
            var arr = [];
            var str = '<option>请选择</option>';
            for (var i in msg) {
                str += '<option value="'+msg[i]['id']+'">'+msg[i]['name']+'</option>';
            }

            // 2.将拼接好的HTML代码放在select内
            var arr=[];
            if (obj == 's_province') {
                $('#s_province').html(str);   
            } else {
                obj.next().html(str);
            }
        });
    }
    getCity('s_province',0);

    // 省份改变事件，市改变
    $('#s_province,#s_city,#s_county').change(function(){
        // 0.初始化
        $(this).nextAll().html('<option>请选择</option>');
        //在下面的ajax请求中，$(this)传递不进去，只能定义变量接收$(this),在下面的ajax中使用变量
        var that = $(this);
        // 1.获取值
        var value = $(this).val();

        $('#box>select>option:selected').each(function(){
            var cityid = $(this).val();
            if(cityid != '请选择'){
                $('input[name=cityid]').val(cityid);
            }
        })
        getCity(that,value);
    })

})
</script>
<script>
    $(function(){
        $('#btn').click(function(){
            var infos = getContent();
            $('input[name=doingmess]').val(infos);
        })
    })
</script>
<script>
  $(function() {
    $('#doc-form-file').on('change', function() {
      var fileNames = '';
      $.each(this.files, function() {
        fileNames += '<span class="am-badge">' + this.name + '</span> ';
      });
      $('#file-list').html(fileNames);
    });
  });
</script>
</block>